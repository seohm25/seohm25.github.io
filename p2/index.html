<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bitcount+Prop+Single+Ink:wght@100..900&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Stack+Sans+Notch:wght@200..700&family=Zalando+Sans+Expanded:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
<title>Unseen Force</title>
<!-- 
<canvas id="canvas">
</canvas> -->

  <canvas id="bg-canvas"></canvas>
  <canvas id="dot-canvas"></canvas>

<!-- <div id="controls">
    Humidity: <input id="humidity" type="number" value="50" min="0" max="100"> %
  </div>     this is controling humidity level  -->

 
 <div class="slideshow">
  <img src="01.png">
</div>

<div class="title-container">
    <span class="name">Gala Porras-Kim</span>
</div>
<div class="exhibition-container">
    <span class="exhibition">Unseen Force</span><br>
    <span class="date">Nov 1, 2025 – <br> Dec 5, 2025 </span>
</div>

<div id="weather">
    <p>Temperature: <span id="temp"></span>°C</p>
    <p>Humidity: <span id="humidity"></span>%</p>
    <p>Condition: <span id="condition"></span></p>
  </div>


<style>
  .slideshow {
    position: absolute;
    width: 100vw;
    height: 100vh;
    object-fit: cover; /*이미지 비율 유지하면서 화면 채움 */
    z-index: 10; 
    margin: 0;
    padding: 0;
} 


.title-container {
    position: fixed;
    margin:1%;
    width: 40%;
    height:auto;
    color:white;
    -webkit-text-stroke: 1px black; 
    /* background-color: rgb(255, 141, 60); */
    font-size: 70px;
    z-index: 10;
    font-family: "Inter", sans-serif;
  }

.exhibition-container {
    position: fixed;
    right:5%;
    top:0px;
    color:white;
    -webkit-text-stroke: 1px black; 
    /* background-color: rgb(0, 221, 255); */
    margin:1%;
    width: 50%;
    font-size: 70px;
    align-content: right;
    z-index: 10;
    font-family: "Inter", sans-serif;

}

#weather {
    position: fixed;
    color:white;
    -webkit-text-stroke: 0.5px black; 
    /* background-color: yellowgreen; */
    font-size: 50px;
    top:300px;
    z-index: 10;
    font-family: "Inter", sans-serif;
    margin:1.2%;
}



  body, html {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: white;

  }
  #bg-canvas {
    position: fixed;
    display: block;
    width: 100vw;
    height: 100vh;
    background-color:rgb(227, 227, 227);
     z-index: 1;
  }

  #dot-canvas {
    position: fixed;
    display: block;
    width: 100vw;
    height: 100vh;
    background-color: transparent;
    z-index: 9999;
  }
  
</style>
</head>
<body>
  
  <script>
    const canvas = document.getElementById('dot-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    
    // 점 설정
    const NUM_DOTS = 100;
    const dots = [];
    
    // 날씨 정보
    let temp = 20;
    let humidity = 20; // 초기값, API로 가져올 예정
    let blur = 20;
    
    //  점 생성 (속도 추가)
    for(let i=0; i<NUM_DOTS; i++){
        dots.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            radius: Math.random() * 7 + 3,
    
            // 초기 속도 (천천히, 랜덤)
            vx: (Math.random() - 0.5) * 0.3,
            vy: (Math.random() - 0.5) * 0.3
        });
    }
    
    
    // 날씨 API 
    async function fetchWeather() {
        const apiKey = "91ed1beb04577b46606a9da0c40280e7"; 
        const city = "Providence";
        const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`;
        
        try {
            const res = await fetch(url);
            const data = await res.json();
            humidity = data.main.humidity;
            blur = map(humidity, 0, 100, 0, 50); 
        } catch (err) {
            console.log("Weather API fetch error", err);
        }
    }
    
    // Map function
    function map(value, in_min, in_max, out_min, out_max){
        return (value - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
    }


    // 더 원의 경계 부드럽게
    function drawSoftDot(x, y, radius, alpha) {
    const layers = 5;
    for (let i = 0; i < layers; i++) {
        ctx.beginPath();
        ctx.arc(x, y, radius + i*1.5, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255,255,255,${alpha / (i+1)})`;
        ctx.fill();
    }
}



//방문자 수 확인  
// let visitorCount = 1;

// async function fetchVisitorCount() {
//     try {
//         const res = await fetch("https://counterapi.com/v1/your-namespace/your-counter");
//         const data = await res.json();
//         visitorCount = data.value;
//     } catch (err) {
//         console.log("Visitor count fetch error", err);
//     }
// }

// fetchVisitorCount();
// setInterval(fetchVisitorCount, 30000); // 30초마다 갱신
//     getWeather();
//     setInterval(getWeather, 1000 * 60 * 5);

    
    // 애니메이션 — 공기처럼 흐르는 방식
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    
        dots.forEach(dot => {
    
            // 온도에 따라 속도 변화: 낮으면 느리고, 높으면 활발
            const speedFactor = map(temp, -20, 40, 0.5, 3.0); // -20°C ~ 40°C → 0.5 ~ 3.0 배 속도

            // 공기처럼 흐르는 움직임
            dot.vx += (Math.random() - 0.5) * 0.02 * speedFactor;
            dot.vy += (Math.random() - 0.5) * 0.02 * speedFactor;

            // 2) 감속 (공기 저항)
            dot.vx *= 0.98;
            dot.vy *= 0.98;
    
            // 3) 위치 업데이트
            dot.x += dot.vx;
            dot.y += dot.vy;
    
            // 경계 체크 (벽을 넘어가면 반대쪽으로)
            if(dot.x < 0) dot.x = canvas.width;
            if(dot.x > canvas.width) dot.x = 0;
            if(dot.y < 0) dot.y = canvas.height;
            if(dot.y > canvas.height) dot.y = 0;

            //humidity에 따라 dot크기 달라짐 
            dot.radius = map(humidity, 0, 100, 2, 8);
    

            // 점 그리기
            drawSoftDot(dot.x, dot.y, dot.radius, 0.5); //좀 더 포자같음 
            ctx.fillStyle = 'rgba(255,255,255,0.15)';
            ctx.shadowBlur = blur * 3.0;        // 기본 블러
            ctx.filter = `blur(${blur*1.5}px)`;   
            ctx.beginPath();
            ctx.arc(dot.x, dot.y, dot.radius, 0, Math.PI * 2);
            ctx.fill();
        });
    
        // //⭐ ⭐  테스트용 값
        // temp = 20;       // 낮은 온도
        // humidity = 30;  // 낮은 습도
        // blur = map(humidity, -20, 100, 0, 50);
        // requestAnimationFrame(animate);
        // const speedFactor = map(temp, -20, 40, 0.1, 1.2) 
        //           * map(visitorCount, 1, 1000, 0.5, 2.0);

    }
    
    // 초기 실행
    fetchWeather();
    setInterval(fetchWeather, 60000);
    animate();
    
    // 날씨 표시
    const API_KEY = "91ed1beb04577b46606a9da0c40280e7";
    const CITY = "Providence";
    
    async function getWeather() {
        const url = `https://api.openweathermap.org/data/2.5/weather?q=${CITY}&appid=${API_KEY}&units=metric`;
    
        const res = await fetch(url);
        const data = await res.json();

        temp = data.main.temp;          // 온도 저장
    humidity = data.main.humidity;  // 습도 저장
    blur = map(humidity, 0, 100, 0, 50); 
    
        document.getElementById("temp").textContent = data.main.temp;
        document.getElementById("humidity").textContent = data.main.humidity;
        document.getElementById("condition").textContent = data.weather[0].main;
    }
 
    </script>
    


</script>
</body>
</html>
